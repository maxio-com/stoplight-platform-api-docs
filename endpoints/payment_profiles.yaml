---
"/payment_profiles/{payment_profile_id}.json":
  parameters:
  - schema:
      type: integer
    name: payment_profile_id
    in: path
    required: true
    description: The Chargify id of the payment profile
  get:
    summary: Read Payment Profile
    tags:
    - Payment Profiles
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                payment_profile:
                  anyOf:
                  - properties:
                      id:
                        type: integer
                      first_name:
                        type: string
                      last_name:
                        type: string
                      customer_id:
                        type: integer
                      current_vault:
                        type: string
                      vault_token:
                        type: string
                      billing_address:
                        type: string
                      billing_city:
                        type: string
                      billing_state:
                        type: string
                      billing_zip:
                        type: string
                      billing_country:
                        type: string
                      customer_vault_token:
                        type: 'null'
                      billing_address_2:
                        type: string
                      bank_name:
                        type: string
                      masked_bank_routing_number:
                        type: string
                      masked_bank_account_number:
                        type: string
                      bank_account_type:
                        type: string
                      bank_account_holder_type:
                        type: string
                      payment_type:
                        type: string
                      verified:
                        type: boolean
                        default: false
                        description: denotes whether a bank account has been verified
                          by providing the amounts of two small deposits made into
                          the account
                      site_gateway_setting_id:
                        type: integer
                      gateway_handle:
                        type: string
                        nullable: true
                  - properties:
                      id:
                        type: integer
                      first_name:
                        type: string
                      last_name:
                        type: string
                      masked_card_number:
                        type: string
                      card_type:
                        type: string
                      expiration_month:
                        type: integer
                      expiration_year:
                        type: integer
                      customer_id:
                        type: integer
                      current_vault:
                        type: string
                      vault_token:
                        type: string
                      billing_address:
                        type: string
                      billing_city:
                        type: string
                      billing_state:
                        type: string
                      billing_zip:
                        type: string
                      billing_country:
                        type: string
                      customer_vault_token:
                        type: 'null'
                      billing_address_2:
                        type: string
                      payment_type:
                        type: string
                      disabled:
                        type: boolean
                      site_gateway_setting_id:
                        type: string
                      gateway_handle:
                        type: string
                        nullable: true
                  type: object
            examples:
              Card:
                value:
                  payment_profile:
                    id: 10088716
                    first_name: Test
                    last_name: Subscription
                    masked_card_number: XXXX-XXXX-XXXX-1
                    card_type: bogus
                    expiration_month: 1
                    expiration_year: 2022
                    customer_id: 14543792
                    current_vault: bogus
                    vault_token: '1'
                    billing_address: 123 Montana Way
                    billing_city: Billings
                    billing_state: MT
                    billing_zip: '59101'
                    billing_country: US
                    customer_vault_token:
                    billing_address_2: ''
                    payment_type: credit_card
                    site_gateway_setting_id: 1
                    gateway_handle:
              Bank Account:
                value:
                  payment_profile:
                    id: 10089892
                    first_name: Chester
                    last_name: Tester
                    customer_id: 14543792
                    current_vault: bogus
                    vault_token: '0011223344'
                    billing_address: 456 Juniper Court
                    billing_city: Boulder
                    billing_state: CO
                    billing_zip: '80302'
                    billing_country: US
                    customer_vault_token:
                    billing_address_2: ''
                    bank_name: Bank of Kansas City
                    masked_bank_routing_number: XXXX6789
                    masked_bank_account_number: XXXX3344
                    bank_account_type: checking
                    bank_account_holder_type: personal
                    payment_type: bank_account
                    site_gateway_setting_id: 1
                    gateway_handle:
    operationId: readPaymentProfile
    description: |-
      Using the GET method you can retrieve a Payment Profile identified by its unique ID.

      Please note that a different JSON object will be returned if the card method on file is a bank account.

      ### Response for Bank Account

      Example response for Bank Account:

      ```
      {
        "payment_profile": {
          "id": 10089892,
          "first_name": "Chester",
          "last_name": "Tester",
          "customer_id": 14543792,
          "current_vault": "bogus",
          "vault_token": "0011223344",
          "billing_address": "456 Juniper Court",
          "billing_city": "Boulder",
          "billing_state": "CO",
          "billing_zip": "80302",
          "billing_country": "US",
          "customer_vault_token": null,
          "billing_address_2": "",
          "bank_name": "Bank of Kansas City",
          "masked_bank_routing_number": "XXXX6789",
          "masked_bank_account_number": "XXXX3344",
          "bank_account_type": "checking",
          "bank_account_holder_type": "personal",
          "payment_type": "bank_account",
          "site_gateway_setting_id": 1,
          "gateway_handle": null
        }
      }
      ```
  put:
    summary: Update Payment Profile
    tags:
    - Payment Profiles
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                payment_profile:
                  type: object
                  properties:
                    id:
                      type: integer
                    first_name:
                      type: string
                    last_name:
                      type: string
                    card_type:
                      type: string
                    expiration_month:
                      type: integer
                    expiration_year:
                      type: integer
                    customer_id:
                      type: integer
                    current_vault:
                      type: string
                    vault_token:
                      type: string
                    billing_address:
                      type: string
                    billing_city:
                      type: string
                    billing_state:
                      type: string
                    billing_zip:
                      type: string
                    billing_country:
                      type: string
                    payment_type:
                      type: string
                    site_gateway_setting_id:
                      type: integer
                    gateway_handle:
                      type: string
                      nullable: true
            examples:
              Example:
                value:
                  payment_profile:
                    id: 10088716
                    first_name: Test
                    last_name: Subscription
                    masked_card_number: XXXX-XXXX-XXXX-1
                    card_type: bogus
                    expiration_month: 1
                    expiration_year: 2022
                    customer_id: 14543792
                    current_vault: bogus
                    vault_token: '1'
                    billing_address: 123 Montana Way
                    billing_city: Billings
                    billing_state: MT
                    billing_zip: '59101'
                    billing_country: US
                    customer_vault_token:
                    billing_address_2: ''
                    payment_type: credit_card
                    site_gateway_setting_id: 1
                    gateway_handle:
    operationId: updatePaymentProfile
    description: |-
      ## Partial Card Updates

      In the event that you are using the Authorize.net, Stripe, Cybersource, Forte or Braintree Blue payment gateways, you can update just the billing and contact information for a payment method. Note the lack of credit-card related data contained in the JSON payload.

      In this case, the following JSON is acceptable:

      ```
      {
        "payment_profile": {
          "first_name": "Kelly",
          "last_name": "Test",
          "billing_address": "789 Juniper Court",
          "billing_city": "Boulder",
          "billing_state": "CO",
          "billing_zip": "80302",
          "billing_country": "US",
          "billing_address_2": null
        }
      }
      ```

      The result will be that you have updated the billing information for the card, yet retained the original card number data.

      ## Specific notes on updating payment profiles

      - Merchants with **Authorize.net**, **Cybersource**, **Forte**, **Braintree Blue** or **Stripe** as their payment gateway can update their Customer’s credit cards without passing in the full credit card number and CVV.

      - If you are using **Authorize.net**, **Cybersource**, **Forte**, **Braintree Blue** or **Stripe**, Chargify will ignore the credit card number and CVV when processing an update via the API, and attempt a partial update instead. If you wish to change the card number on a payment profile, you will need to create a new payment profile for the given customer.

      - A Payment Profile cannot be updated with the attributes of another type of Payment Profile. For example, if the payment profile you are attempting to update is a credit card, you cannot pass in bank account attributes (like `bank_account_number`), and vice versa.

      - Updating a payment profile directly will not trigger an attempt to capture a past-due balance. If this is the intent, update the card details via the Subscription instead.

      - If you are using Authorize.net or Stripe, you may elect to manually trigger a retry for a past due subscription after a partial update.
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              payment_profile:
                type: object
                properties:
                  first_name:
                    type: string
                  last_name:
                    type: string
                  full_number:
                    type: string
                  card_type:
                    type: string
                  expiration_month:
                    type: string
                  expiration_year:
                    type: string
                  current_vault:
                    type: string
                  billing_address:
                    type: string
                  billing_city:
                    type: string
                  billing_state:
                    type: string
                  billing_zip:
                    type: string
                  billing_country:
                    type: string
                  billing_address_2:
                    type: string
                    nullable: true
          examples:
            Example:
              value:
                payment_profile:
                  first_name: Graham
                  last_name: Test
                  full_number: '4111111111111111'
                  card_type: master
                  expiration_month: '04'
                  expiration_year: '2030'
                  current_vault: bogus
                  vault_token: '1'
                  billing_address: 456 Juniper Court
                  billing_city: Boulder
                  billing_state: CO
                  billing_zip: '80302'
                  billing_country: US
                  billing_address_2:
  delete:
    summary: Delete Unused Payment Profile
    tags:
    - Payment Profiles
    responses:
      '204':
        description: No Content
      '422':
        description: Unprocessable Entity (WebDAV)
        content:
          application/json:
            schema:
              type: object
              properties:
                errors:
                  type: array
                  items:
                    type: string
            examples:
              Example:
                value:
                  errors:
                  - The payment profile is in use by one or more subscriptions and
                    cannot be deleted
    operationId: deleteUnusedPaymentProfile
    description: |-
      Deletes an unused payment profile.

      If the payment profile is in use by one or more subscriptions or groups, a 422 and error message will be returned.
